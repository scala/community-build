// https://github.com/scalameta/scalameta.git#v4.3.24

// frozen (November 2020) at version current scalamft expects.
// unfreezing might be possible, I didn't try

vars.proj.scalameta: ${vars.base} {
  name: "scalameta"
  uri: "https://github.com/scalameta/scalameta.git#33d1801032c9e741398301e68f08b5537ba22028"

  extra.projects: ["semanticdbScalacPlugin", "testkit"]
  extra.options: ["-XX:+IgnoreUnrecognizedVMOptions"]
  extra.commands: ${vars.default-commands} [
    // use right version-specific source directories regardless of our weird dbuild Scala version numbers
    """set common.jvm / Compile / unmanagedSourceDirectories += baseDirectory.value / "scalameta" / "common" / "shared" / "src" / "main" / "scala-2.13""""
    """set semanticdbScalacCore / Compile / unmanagedSourceDirectories += baseDirectory.value / "semanticdb" / "scalac" / "library" / "src" / "main" / "scala-2.13""""
    // not supported on JDK 11+
    "removeJavaOptions -XX:+UseParNewGC"
  ]
}
