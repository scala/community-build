// https://github.com/scalacommunitybuild/akka-persistence-jdbc.git#community-build-2.12  # was dnvriend, v3.5.2

// dependency of lagom. frozen at version lagom currently (December 2019) expects

// then forked (August 2022) to cherry-pick a later commit that removes unused
// code that uses scala.xml.pull (which is removed in scala-xml 2.0)

vars.proj.akka-persistence-jdbc: ${vars.base} {
  name: "akka-persistence-jdbc"
  uri: "https://github.com/scalacommunitybuild/akka-persistence-jdbc.git#9c8d94da73275d6ec94c577a7031a325e118e74a"

  extra.options: ["-Dbintray.user=dummy", "-Dbintray.pass=dummy"]
  extra.commands: ${vars.default-commands} [
    "set every bintrayReleaseOnPublish := false"
    // test code relies on removed scala-xml API. (the test was removed
    // later on master anyway)
    """set Test / unmanagedSources / excludeFilter := HiddenFileFilter || "ClasspathResources.scala""""
  ]
  // it isn't clear to me that there are any tests we can run without
  // doing the Docker stuff in their test.sh script.  we might ask the
  // Akka team if there is any segregation between unit vs. integration tests,
  // that kind of thing?
  extra.test-tasks: "compile"
}
