// https://github.com/scalacommunitybuild/scalafix.git#community-build-2.13  # was scalacenter, main

// forked (September 2021) to remove tests that don't compile
// under -Xsource:3

vars.proj.scalafix: ${vars.base} {
  name: "scalafix"
  uri: "https://github.com/scalacenter/scalafix.git#fd4ce4630c9d0bc374db766c6737b3925e622046"

  extra.sbt-version: ${vars.sbt-1-5-version}  // https://github.com/scoverage/sbt-scoverage/issues/372
  extra.exclude: [
    // out of scope
    "docs"
    // it would really be better if we could build and run the tests, but
    // the effort to do so in https://github.com/scala/community-build/pull/1290
    // ran aground. we should try again once ScalaTest 3.0 doesn't need to be part
    // of the picture anymore
    "unit"
  ]
  extra.commands: ${vars.default-commands} [
    // so we can still build even with -Xsource:3
    """set testsInput / Compile / unmanagedSources / excludeFilter := HiddenFileFilter || "ConstructorProcedureSyntax.scala" || "ProcedureSyntax.scala" || "ExplicitUnit.scala" || "BetterRscCompat.scala" || "RemoveUnusedTerms.scala" || "AnnotationScopes.scala" || "NoValInForComprehension.scala" || "AnchorExpression.scala" || "AnchorMultipleRules.scala" || "NoUnitInsertion.scala""""
    """set testsOutput / Compile / unmanagedSources / excludeFilter := HiddenFileFilter || "NoValInForComprehension.scala" || "BetterRscCompat.scala" || "RemoveUnusedTerms.scala""""
  ]
}
