// https://github.com/scalacenter/scalafix.git#main

vars.proj.scalafix: ${vars.base} {
  name: "scalafix"
  uri: "https://github.com/scalacenter/scalafix.git#6cd00c0cce3cce9190e9de3b30d217494ccc2f3c"

  // as per https://github.com/scalacenter/scalafix/issues/1699 we don't
  // include "*2_13" because we can't build many subprojects, including most test
  // subprojects, because they use sun.misc.Unsafe which is JDK 8 only
  extra.projects: ["interfaces", "core2_13", "rules2_13"]
  extra.commands: ${vars.default-commands} [
    // these tests fail because they're fetching dbuild-built dependencies
    // (Scalameta and Scalafix itself) at runtime. I didn't dig into it.
    // CliGitDiffSuite is something else I didn't investigate either.
    """set unit.allProjects.map(_._1).find(_.id == "unit2_13Target2_13").get / unmanagedSources / excludeFilter := HiddenFileFilter || "ScalafixImplSuite.scala" || "ScalafixSuite.scala" || "ScalafixArgumentsSuite.scala" || "CliGitDiffSuite.scala""""
  ]
}
