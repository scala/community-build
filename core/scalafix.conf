// https://github.com/scalacommunitybuild/scalafix.git#community-build-2.13  # was scalacenter, main

// forked (February 2022) to adapt to Scalameta 4.5.0 change;
// probably before long scalafix will do the upgrade themselves
// and we'll be able to unfork

vars.proj.scalafix: ${vars.base} {
  name: "scalafix"
  uri: "https://github.com/scalacommunitybuild/scalafix.git#84ea49429200b27d0d53e2225390ce981d8cc4dd"

  extra.exclude: [
    // out of scope
    "docs"
    // it would really be better if we could build and run the tests, but
    // the September 2021 effort to do so stalled; for details, see
    // https://github.com/scala/community-build/pull/1489
    "unit"
  ]
  extra.commands: ${vars.default-commands} [
    // so we can still build even with -Xsource:3
    """set testsInput / Compile / unmanagedSources / excludeFilter := HiddenFileFilter || "ConstructorProcedureSyntax.scala" || "ProcedureSyntax.scala" || "ExplicitUnit.scala" || "BetterRscCompat.scala" || "RemoveUnusedTerms.scala" || "AnnotationScopes.scala" || "NoValInForComprehension.scala" || "AnchorExpression.scala" || "AnchorMultipleRules.scala" || "NoUnitInsertion.scala""""
    """set testsOutput / Compile / unmanagedSources / excludeFilter := HiddenFileFilter || "NoValInForComprehension.scala" || "BetterRscCompat.scala" || "RemoveUnusedTerms.scala""""
  ]
}
